(this.webpackJsonpfinal_project=this.webpackJsonpfinal_project||[]).push([[0],{55:function(e,t,a){e.exports=a(90)},60:function(e,t,a){},61:function(e,t,a){},90:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),l=a(22),c=a.n(l),o=(a(60),a(21)),s=a(19),i=a(12),u=(a(61),a(62),a(92)),m=a(93),d=a(94),f=a(95),g=a(96),p=a(114),E=a(115),b=a(97),h=a(116),v=a(98),O=function(e){var t=e.userData,a=Object(n.useState)(!1),l=Object(i.a)(a,2);l[0],l[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,{color:"light",light:!0,expand:"md"},r.a.createElement(m.a,{href:"/"},"Classic Course Manager"),r.a.createElement(d.a,{className:"mr-auto"},r.a.createElement(f.a,null,r.a.createElement(g.a,null," About")),r.a.createElement(f.a,null,r.a.createElement(g.a,null," GitHub")),r.a.createElement(f.a,null,r.a.createElement(g.a,null," Help "))),r.a.createElement(S,{userData:t})))},j={borderRadius:"50%",maxWidth:"45px",float:"left",display:"inline-box"},y={float:"right",marginTop:"10px",marginLeft:"5px"},S=function(e){var t=e.userData;return r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,{inNavbar:!0},r.a.createElement(E.a,{color:"light"},r.a.createElement(b.a,{style:j,right:!0,object:!0,src:t.picture,alt:"User Image"}),r.a.createElement("p",{style:y},r.a.createElement("b",null,t.given_name))),r.a.createElement(h.a,{right:!0},r.a.createElement(v.a,{href:"/logout"}," Logout "))))},k=a(99),w=a(100),C=a(101),x=a(102),D=a(46),T={fontSize:"0.85vw"},_={width:"40%"},N=function(e){var t=e.courseName,a=e.subjectName,n=e.section,l=e.professorName,c=e.timings,o=e.conflict,s=e.handleRemoveButtonClick,i=e.handleAddButtonClick,u=e.crn,m=e.basket,d={padding:"10px",margin:"5px",textAlign:"left",borderRadius:"5px",borderColor:"#000000",backgroundColor:e.color},f=function(e){var t=e.getHours(),a=e.getMinutes(),n=t>=12?"pm":"am";return(t=(t%=12)||12)+":"+(a=a<10?"0"+a:a)+" "+n};return r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,{style:d},r.a.createElement(w.a,null,r.a.createElement("h4",null,t),o?r.a.createElement(C.a,{style:_,pill:!0,color:"danger"},"CONFLICT"):""),r.a.createElement(x.a,null,a," - ",n),r.a.createElement(x.a,null,"Professor ",l),r.a.createElement("br",null),null===c||void 0===c?void 0:c.map((function(e,t){return r.a.createElement(x.a,{key:t,style:T},["SUN","MON","TUES","WED","THURS","FRI"][e.weekday],": ",f(e.start)," to"," ",f(e.end))})),m?r.a.createElement(D.a,{color:"danger",onClick:function(){s(u)}}," ","Remove from Basket"," "):r.a.createElement(D.a,{color:"primary",onClick:function(){i(u)}}," ","Add to Basket"," ")))},M=a(103),A=a(104),H=a(105),F=a(106),R=a(107),B=a(108),W=a(49),J=a(109),P=function(e){e.requestError;var t=e.handleSubmit,a=e.setValues,n=e.values,l=function(e,t){switch(e){case"crn":a(Object(s.a)({},n,{crn:t}));break;case"class_name":a(Object(s.a)({},n,{class_name:t}));break;case"prof_name":a(Object(s.a)({},n,{prof_name:t}));break;case"class_name":a(Object(s.a)({},n,{class_name:t}))}};return r.a.createElement(r.a.Fragment,null,r.a.createElement(M.a,{fluid:!0,style:{background:"#cbf1f5"}},r.a.createElement(A.a,{onSubmit:function(e){return a=e,console.log(n),void t(a,n);var a},"data-testid":"class-search-form",style:{padding:"13px",width:"100%"}},r.a.createElement(H.a,null,r.a.createElement(F.a,{xl:2},r.a.createElement(R.a,null,r.a.createElement(B.a,{addonType:"prepend"},r.a.createElement(W.a,null,"CRN")),r.a.createElement(J.a,{name:"crn",value:n.crn,onChange:function(e){return l("crn",e.target.value)},placeholder:"12345","data-testid":"crn-input"}))),r.a.createElement(F.a,{xl:2},r.a.createElement(R.a,null,r.a.createElement(B.a,{addonType:"prepend"},r.a.createElement(W.a,null,"Class Name")),r.a.createElement(J.a,{name:"class-name",value:n.class_name,onChange:function(e){return l("class_name",e.target.value)},placeholder:"12345","data-testid":"class-input"}))),r.a.createElement(F.a,{xl:3},r.a.createElement(R.a,null,r.a.createElement(B.a,{addonType:"prepend"},r.a.createElement(W.a,null,"Department")),r.a.createElement(J.a,{name:"dep-name",value:n.dep_name,onChange:function(e){return l("dep_name",e.target.value)},placeholder:"12345","data-testid":"dep-input"}))),r.a.createElement(F.a,{xl:3},r.a.createElement(R.a,null,r.a.createElement(B.a,{addonType:"prepend"},r.a.createElement(W.a,null,"Professor Name")),r.a.createElement(J.a,{name:"prof-name",value:n.prof_name,onChange:function(e){return l("prof_name",e.target.value)},placeholder:"12345","data-testid":"prof-input"}))),r.a.createElement(F.a,{xl:2},r.a.createElement(D.a,{type:"submit",color:"primary"}," Search "))))))},I=a(118),L=a(112),U=a(50),z=a(54),V=a(51),q=a(52),G=(a(80),a(81),a(82),function(e){var t=e.events,a=e.academicCalEvents,l=Object(n.useState)(new Date),c=Object(i.a)(l,2),s=(c[0],c[1],r.a.createRef()),u=Object(n.useState)(a),m=Object(i.a)(u,2),d=m[0],f=m[1],g=function(e){var t={startTime:"08:00",endTime:"17:45",defaultDate:new Date};if(e.length<1)return t;e.sort((function(e,t){return e.start>t.start?1:-1})),t.defaultDate=e[0].start;var a=(e[0].start.getHours()-1).toString(),n=e[0].start.getMinutes().toString();a=("00000"+a).slice(-2),n=("00000"+n).slice(-2);var r=(e[e.length-1].end.getHours()+1).toString(),l=e[e.length-1].end.getMinutes().toString();r=("00000"+r).slice(-2),l=("00000"+l).slice(-2);var c=e[e.length-1].end.getHours()>17,o=e[0].start.getHours()<8;return e[e.length-1].end.getHours()-e[0].start.getHours()>=7||c||o||(t.startTime="".concat(a,":").concat(n),t.endTime="".concat(r,":").concat(l)),t},p=Object(n.useState)(g(d)),E=Object(i.a)(p,2),b=E[0],h=E[1];return Object(n.useEffect)((function(){var e=Object(o.a)(a),t=s.current;if(t){var n=t.getApi(),r=e.sort((function(e,t){return e.start>t.start?1:-1}));e.length>1&&n.gotoDate(r[0].start)}f(a)}),[a]),Object(n.useEffect)((function(){var e=[];t.map((function(e){var t,a=e,n=null===(t=e.timings)||void 0===t?void 0:t.map((function(e){return{start:new Date(e.start),end:new Date(e.end),weekday:e.weekday,rrule:e.rrule,duration:e.duration}}));return a.timings=n,a})).forEach((function(t){var a;null===(a=t.timings)||void 0===a||a.forEach((function(a){e.push({start:a.start,end:a.end,title:t.courseName,allDay:!1,rrule:a.rrule,duration:a.duration,color:t.color})}))})),console.log("this is new event state",e),f([].concat(Object(o.a)(a),e)),h(g([].concat(e)))}),[t]),r.a.createElement(r.a.Fragment,null,b.startTime,b.endTime,r.a.createElement(U.a,{events:d,defaultView:"timeGridWeek",plugins:[z.a,V.a,q.a],weekends:!1,slotDuration:{minutes:30},minTime:"07:30",maxTime:"22:45",slotEventOverlap:!0,allDaySlot:!0,slotLabelInterval:{minutes:90},ref:s}))}),Y=a(117),$=a(110),K=a(111),Q=a(113),X=function(e){var t=e.modal,a=(e.toggle,e.setModal),l=e.loading,c=e.execute,o=e.message,s=e.title,u=e.setMessage,m=e.buttonSettings,d=Object(n.useState)(!1),f=Object(i.a)(d,2),g=f[0],p=f[1],E=function(){p(!1),u(""),a(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.a,{isOpen:t,toggle:E},r.a.createElement($.a,{toggle:E},s),r.a.createElement(K.a,null,l?r.a.createElement(L.a,{size:"lg"}):function(){if("success"==m.type){var e=o.split("!");return r.a.createElement(r.a.Fragment,null,e.shift(),r.a.createElement("ul",null,e.map((function(e){return r.a.createElement("li",null,e)}))))}return o}()),r.a.createElement(Q.a,null,r.a.createElement(D.a,{disabled:g,color:m.type,onClick:function(){c(),p(!0)}},m.text)," ",r.a.createElement(D.a,{color:"secondary",onClick:E},"Cancel"))))},Z={id:"",title:"Select a calendar",color:"#f0f0f0",primary:!1,selected:!1};var ee=function(){var e,t=Object(n.useState)(""),a=Object(i.a)(t,2),l=a[0],c=(a[1],Object(n.useState)([])),u=Object(i.a)(c,2),m=u[0],d=u[1],f=Object(n.useState)([]),g=Object(i.a)(f,2),b=g[0],j=g[1],y=Object(n.useState)(!1),S=Object(i.a)(y,2),k=S[0],w=S[1],C=Object(n.useState)([]),x=Object(i.a)(C,2),T=x[0],_=x[1],A=Object(n.useState)({}),R=Object(i.a)(A,2),B=R[0],W=R[1],J=Object(n.useState)(Z),U=Object(i.a)(J,2),z=U[0],V=U[1],q=Object(n.useState)(!1),Y=Object(i.a)(q,2),$=Y[0],K=Y[1],Q=Object(n.useState)(!1),ee=Object(i.a)(Q,2),te=ee[0],ae=ee[1],ne=Object(n.useState)(""),re=Object(i.a)(ne,2),le=re[0],ce=re[1],oe=Object(n.useState)(!1),se=Object(i.a)(oe,2),ie=se[0],ue=se[1],me=Object(n.useState)(!1),de=Object(i.a)(me,2),fe=de[0],ge=de[1],pe=function(){return ue(!ie)},Ee={dep_name:"",crn:"",prof_name:"",class_name:""},be=Object(n.useState)(Ee),he=Object(i.a)(be,2),ve=he[0],Oe=he[1];Object(n.useEffect)((function(){fetch("/api/getacademiccalinfo").then((function(e){return e.json()})).then((function(e){var t;e.error?console.log("Error when fetching response: "+e.message):(t=e.events.map((function(e){var t=new Date,a=new Date;e.start.date&&e.end.date?(t=new Date(Date.parse(e.start.date)),t=new Date(Date.parse(e.end.date))):e.start.dateTime&&e.end.dateTime&&(t=new Date(Date.parse(e.start.dateTime)),a=new Date(Date.parse(e.end.dateTime)));var n=t.getTime()-a.getTime()>828e5;return{start:t,end:a,title:e.summary,allDay:n}})),_(t),fetch("/api/user_data").then((function(e){return e.json()})).then((function(e){var t=e.user_calendar_book;t.sort((function(e,t){return e.selected===t.selected?0:e.selected?-1:1}));var a=Object(s.a)({},e.session,{calendar_book:t});W(a)})))}))}),[]),Object(n.useEffect)((function(){if(B.calendar_book){var e=B.calendar_book.filter((function(e){return e.primary}))[0];V(e)}}),[B]);var je,ye=function(){var e=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};return function(){var t=e(0,360),a=e(42,98),n=e(40,90);return"hsl(".concat(t,",").concat(a,"%,").concat(n,"%)")}}(),Se=function(e){var t=m;t=t.filter((function(t){return t.crn===e&&j([].concat(Object(o.a)(b),[t])),t.crn!==e})),console.log(t),d(t)},ke=function(e){j(b.filter((function(t){return t.crn!==e})));var t=b.filter((function(t){return t.crn===e}));d([].concat(Object(o.a)(m),Object(o.a)(t)))},we={borderColor:"grey",borderWidth:"2px",borderStyle:"solid",height:"80vh"};return r.a.createElement("div",{className:"App"},r.a.createElement(O,{userData:B}),fe?r.a.createElement(X,{modal:ie,toggle:pe,setModal:ue,execute:function(){ae(!0);var e={basket:m,calendar_id:z.id};fetch("/api/user_events",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){console.log(e);var t=e.body.map((function(e){return e.summary})),a="The following classes have been added:!"+(t=t.filter((function(e,a){return t.indexOf(e)===a}))).join("!");ce(a),ae(!1),d([])}))},loading:te,message:le,setMessage:ce,title:"Calendar Export",buttonSettings:{type:"success",text:"Export classes"}}):r.a.createElement(X,{modal:ie,toggle:pe,setModal:ue,execute:function(){ae(!0),fetch("/api/clear_events",{method:"POST",body:JSON.stringify({calendar_id:z.id}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){console.log(e),ae(!1),ce("All Classic Events were deleted successfully!")})).catch((function(e){console.log(e),ae(!1),ce("An error occured")}))},loading:te,message:le,setMessage:ce,title:"Clear Classic Events",buttonSettings:{type:"danger",text:"Delete Events"}}),r.a.createElement(M.a,{fluid:!0},r.a.createElement(H.a,null,r.a.createElement(F.a,{xl:12},r.a.createElement(P,{handleSubmit:function(e,t){e.preventDefault(),w(!1),K(!0),j([]),m.filter((function(e){return e.crn==l})).length<1?fetch("/api/getinfo",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then((function(e){try{return e.json()}catch(t){throw console.log(t),t}})).then((function(e){if(e.error)throw new Error(e.message);return console.log(e),e})).then((function(e){var t=e.results.map((function(e){var t=e.timings.map((function(e){return{weekday:new Date(e.start).getDay(),start:new Date(e.start),end:new Date(e.end),rrule:e.rrule,duration:e.duration}}));return{courseName:e.name,subjectName:e.sname,section:e.section,professorName:e.professor__name,crn:e.crn.toString(),timings:t,color:ye()}}));console.log(JSON.stringify(t)),j(t)})).catch((function(e){w(!0),console.log("OOOO",e)})).finally((function(){Oe(Ee),K(!1)})):w(!0)},setValues:Oe,values:ve,requestError:k}),k?r.a.createElement(I.a,{label:"errmsg",color:"danger"},"There was an error. Please try again."):"")),r.a.createElement(H.a,null,r.a.createElement(F.a,{xl:2,style:Object(s.a)({},we,{overflowY:"auto"})},$?r.a.createElement(L.a,{style:{width:"8rem",height:"8rem",marginTop:"100%"}}):"",b.map((function(e,t){if(!m.map((function(e){return e.crn})).includes(e.crn))return r.a.createElement(N,Object.assign({key:t,handleAddButtonClick:ke},e))}))),r.a.createElement(F.a,{xl:2,style:we},m.map((function(e,t){return r.a.createElement(N,Object.assign({key:t,handleRemoveButtonClick:Se,basket:!0},e))}))),r.a.createElement(F.a,{xl:6,style:we},r.a.createElement(G,{events:m,academicCalEvents:T})),r.a.createElement(F.a,{xl:2,style:we},r.a.createElement(p.a,{group:!0,size:"md"},r.a.createElement(E.a,{style:(je=z,{backgroundColor:je.color}),caret:!0}," ",z.title),r.a.createElement(h.a,null,null===(e=B.calendar_book)||void 0===e?void 0:e.map((function(e,t){var a=e.id==z.id;return r.a.createElement(v.a,{active:a,key:t,onClick:function(){return V(e)}},e.title)})))),r.a.createElement(D.a,{disabled:!(m.length>0),onClick:function(){ge(!0),ce("You are about to export your basket. Are you sure?"),pe()},color:"primary"},"Export to Calendar"),r.a.createElement(D.a,{color:"danger",onClick:function(){ge(!1),ce("Would you like to clear all Classic events for: "+z.title+"?"),pe()}},"Clear Calendar")))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ee,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[55,1,2]]]);
//# sourceMappingURL=main.bb706140.chunk.js.map